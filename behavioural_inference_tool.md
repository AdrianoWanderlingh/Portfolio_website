# Development of an analytical suite for the detection of ant behaviours

Social insects like ants utilize complex behavioral strategies to manage disease transmission within their colonies. This project utilizes an analytical suite based on machine learning, which I developed during my doctoral research, to automatically detect allogrooming behavior in ants from tracking data. Allogrooming, where one ant cleans another, is crucial for maintaining health within the colony.

This project demonstrates the application of data science techniques in behavioral ecology, specifically using supervised classifiers and techniques for dealing with imbalanced data.

<p>
    <img src="images/beh_inf_tool_scheme.png?raw=true" alt="Overview of the Behavioural Inference Tool">
    <br>
    <em>Overview of the Behavioural Inference Tool</em>
</p>

The Behavioral Inference Tool, developed as part of this research, automates the detection of allogrooming by tracking physical interactions and applying machine learning to predict behaviors based on these interactions.

## Data Collection and Preparation

Ants were tracked using marker-based methods, with interactions manually annotated to create a ground truth dataset. Automated methods then identified potential grooming interactions. Data was split into training, validation, and test sets. Machine learning models were trained on features derived from the tracking data, including movement statistics of the ants involved in each interaction.

### Interaction Extraction

Physical interactions were defined using geometric parameters to capture the sequence of allogrooming actions. A total of 3150 datasets were generated by varying these parameters to optimize detection accuracy. The automatically extracted interactions were then labeled with the ground truth from manual annotations, creating a labeled dataset for model training.

<p>
    <img src="images/interaction_picture_scheme.jpg?raw=true" alt="Detail of Interaction Extraction Method" width="75%">
    <br>
    <em>Detail of Interaction Extraction Method. A. an ant overlaid with the capsules to model the front end, or ‘head’, in green and the body in yellow. B. an interaction (red line) is inferred when the ‘head’ capsule of an ant overlaps with the body capsule of another ant. C. detected interactions (red lines) among pairs of individuals (in yellow).</em>
</p>

<p>
    <img src="images/grooming_interactions_plot.jpg?raw=true" alt="Visualization of ant allogrooming interactions">
    <br>
    <em>The trajectories of the actors (in blue) are the receivers (in red) during three example allogrooming interactions, from which the  summary statistics were calculated.</em>
</p>


### Feature Engineering

A total of sixty-four summary statistics were used as features for the machine learning model. These statistics describe the movement and orientation of the ants during their interactions, providing a rich dataset for predicting behaviors. Features were selected using a Relief-based algorithm to enhance model performance. Class imbalance was addressed using over-sampling and under-sampling techniques to ensure the model's robustness across varied data samples.

## Results

### Development of the analytical suite

This work resulted in the creation of a comprehensive suite of scripts and functions for analyzing and inferring behaviors from tracking data of ant colonies. It provides functionalities for extracting movement variables, detecting and filtering interactions, predicting grooming behavior, and evaluating the performance of machine learning classifiers.

<p>
    <img src="images/Tool_overview_behavioural.png?raw=true" alt="Overview of the Behavioural Inference Tool">
    <br>
    <em>Overview of the data processing and classification workflow in the Behavioural Inference Tool.</em>
</p>

### Model Selection and Validation

Out of the 4209 trained models, the Random Forest model, balanced with the Synthetic Minority Over-sampling Technique (SMOTE), provided the best performance. It demonstrated strong precision and sensitivity in identifying allogrooming behaviors from the tracking data.

<p>
    <img src="images/precision_sensitivity_scores.png?raw=true" alt="Precision and Sensitivity of Various Models" width="75%">
    <br>
    <em>Precision and Sensitivity of Various Models</em>
</p>

### Generalization to Test Data

The selected model was then tested on unseen data, where it continued to accurately predict allogrooming behavior, confirming its robustness and potential for broader application.

| Metric      | Score  |
| ----------- | :----: |
| Sensitivity | 75.8%  |
| Precision   | 82.1%  |

<p>
    <img src="images/OOB_plot.png?raw=true" alt="Out-of-Bag Error Plot">
    <br>
    <em>Out-of-Bag (OOB) error plot for the random forest model showing the error rates for grooming and non-grooming classes over iterations.</em>
</p>

This project highlights the potential of machine learning in transforming behavioral ecology research. By automating the detection of complex behaviors like allogrooming, we can analyze much larger datasets than would be feasible manually. This opens up new avenues for understanding the dynamics of social immunity in ant colonies.

## Repository Link

All project codes and datasets are available in my [GitHub repository](https://github.com/AdrianoWanderlingh/Ant_Tracking/tree/main/Scripts/PhD-Ant_Colonies_Tracking_Analysis/Automated_Behavioural_Inference).
